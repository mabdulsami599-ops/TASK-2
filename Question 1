#include <stdio.h>
#include <stdbool.h>
#include <stdlib.h>

#define SIZE 24
#define nRows 8
#define nCols 3

//Function Prototypes
void print_array(int arr[], int len);
void print_matrix(int mat[][nCols], int rows);
void set_array(int arr[], int len);
void rem_align(int arr[], int len, int pos);
void insert_align(int arr[], int len, int pos, int val);
void reshape(int arr[], int len, int arr2d[][nCols], int rows);
void print_trans_matrix(int arr2d[][nCols], int rows);
bool found_duplicate(int arr[], int len);
int* flip_array(int arr[], int len);

// Function Definitions 


// element equals its index
void set_array(int arr[], int len) {
    for (int i = 0; i < len; ++i)
        arr[i] = i;
}

// Remove element at the given index and shift elements left
void rem_align(int arr[], int len, int pos) {
    if (pos < 0 || pos >= len) {
        printf("Error: Invalid index %d\n", pos);
        return;
    }

    for (int i = pos; i < len - 1; ++i)
        arr[i] = arr[i + 1];
}

// Insert a value at a specific position and shift the elements right
void insert_align(int arr[], int len, int pos, int val) {
    if (pos < 0 || pos >= len) {
        printf("Error: Invalid index %d\n", pos);
        return;
    }

    for (int i = len - 1; i > pos; --i)
        arr[i] = arr[i - 1];

    arr[pos] = val;
}

// Convert a 1D array into a 2D matrix layout
void reshape(int arr[], int len, int arr2d[][nCols], int rows) {
    if (len != rows * nCols) {
        printf("Error: Size mismatch — %d elements vs %d×%d matrix\n", len, rows, nCols);
        return;
    }

    int k = 0;
    for (int i = 0; i < rows; ++i)
        for (int j = 0; j < nCols; ++j)
            arr2d[i][j] = arr[k++];
}

// Print 2D matrix
void print_trans_matrix(int arr2d[][nCols], int rows) {
    for (int c = 0; c < nCols; ++c) {
        for (int r = 0; r < rows; ++r)
            printf("%d ", arr2d[r][c]);
        printf("\n");
    }
}

// check for dublicate elements
bool found_duplicate(int arr[], int len) {
    for (int i = 0; i < len; ++i)
        for (int j = i + 1; j < len; ++j)
            if (arr[i] == arr[j])
                return true;
    return false;
}


int* flip_array(int arr[], int len) {
    int *rev = malloc(len * sizeof(int));
    if (!rev) {
        printf("Memory allocation failed.\n");
        exit(1);
    }

    for (int i = 0; i < len; ++i)
        rev[i] = arr[len - 1 - i];

    return rev;
}

// Display contents of a 1D array
void print_array(int arr[], int len) {
    for (int i = 0; i < len; ++i)
        printf("%d ", arr[i]);
    printf("\n");
}

// Display contents of a 2D matrix
void print_matrix(int mat[][nCols], int rows) {
    for (int i = 0; i < rows; ++i) {
        for (int j = 0; j < nCols; ++j)
            printf("%d ", mat[i][j]);
        printf("\n");
    }
}

// Main Program
int main() {
    int arr[SIZE];
    int arr2d[nRows][nCols];

    printf("Test 1: set_array \n");
    set_array(arr, SIZE);
    print_array(arr, SIZE);

    printf("\n rem_align (remove index 2) \n");
    rem_align(arr, SIZE, 2);
    print_array(arr, SIZE);

    printf("\n insert_align (insert 67 at index 2) \n");
    insert_align(arr, SIZE, 2, 67);
    print_array(arr, SIZE);

    printf("\nreshape \n");
    set_array(arr, SIZE);
    reshape(arr, SIZE, arr2d, nRows);
    printf("Original 1D array:\n");
    print_array(arr, SIZE);
    printf("Reshaped 2D matrix:\n");
    print_matrix(arr2d, nRows);

    printf("\n print_trans_matrix \n");
    print_trans_matrix(arr2d, nRows);

    printf("\n found_duplicate \n");
    printf("%s\n", found_duplicate(arr, SIZE) ? "Duplicates found" : "No duplicates found");

    arr[10] = arr[5];
    if (found_duplicate(arr, SIZE))
        printf("After adding duplicate: Duplicates found\n");

    printf("\n flip_array \n");
    set_array(arr, SIZE);
    printf("Original array:\n");
    print_array(arr, SIZE);

    int *flipped = flip_array(arr, SIZE);
    printf("Flipped array:\n");
    print_array(flipped, SIZE);

    free(flipped);
    return 0;
}
